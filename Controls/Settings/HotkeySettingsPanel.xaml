<UserControl x:Class="YiboFile.Controls.Settings.HotkeySettingsPanel"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <UserControl.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVisConverter"/>
    </UserControl.Resources>
    <Grid Margin="30">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- 标题区 -->
        <StackPanel Grid.Row="0" Margin="0,0,0,20">
            <TextBlock Text="快捷键管理" FontSize="28" FontWeight="Bold" Foreground="{DynamicResource ForegroundPrimaryBrush}"/>
            <TextBlock Text="查看和自定义应用程序快捷键" FontSize="14" Foreground="{DynamicResource ForegroundSecondaryBrush}" Margin="0,8,0,0"/>
        </StackPanel>
        
        <!-- 操作按钮区 -->
        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,15">
            <Button Name="ResetButton" Content="恢复默认" Click="ResetButton_Click"
                    Padding="16,8" MinWidth="100" Background="{DynamicResource BackgroundSecondaryBrush}" BorderBrush="{DynamicResource BorderSubtleBrush}" Cursor="Hand"
                    Style="{StaticResource ModernButtonStyle}"/>
        </StackPanel>
        
        <!-- 快捷键列表 -->
        <Border Grid.Row="2" BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1" CornerRadius="6" Background="{DynamicResource CardBackgroundBrush}">
            <DataGrid Name="HotkeyGrid" 
                      AutoGenerateColumns="False"
                      CanUserAddRows="False"
                      CanUserDeleteRows="False"
                      CanUserResizeRows="False"
                      CanUserSortColumns="True"
                      RowHeaderWidth="0"
                      GridLinesVisibility="None"
                      HeadersVisibility="Column"
                      BorderThickness="0"
                      Background="Transparent"
                      SelectionMode="Single"
                      SelectionUnit="FullRow"
                      PreviewMouseWheel="HotkeyGrid_PreviewMouseWheel">
                <!-- DataGrid样式 -->
                <DataGrid.Resources>
                    <!-- 表头样式 -->
                    <Style TargetType="DataGridColumnHeader">
                        <Setter Property="Background" Value="{DynamicResource PanelBackgroundBrush}"/>
                        <Setter Property="Foreground" Value="{DynamicResource ForegroundPrimaryBrush}"/>
                        <Setter Property="FontWeight" Value="SemiBold"/>
                        <Setter Property="FontSize" Value="13"/>
                        <Setter Property="Padding" Value="16,12"/>
                        <Setter Property="BorderThickness" Value="0,0,0,1"/>
                        <Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}"/>
                        <Setter Property="HorizontalContentAlignment" Value="Left"/>
                    </Style>
                    
                    <!-- 单元格样式 -->
                    <Style TargetType="DataGridCell">
                        <Setter Property="BorderThickness" Value="0"/>
                        <Setter Property="Padding" Value="16,10"/>
                        <Setter Property="Background" Value="Transparent"/>
                        <Setter Property="Foreground" Value="{DynamicResource ForegroundPrimaryBrush}"/>
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="DataGridCell">
                                    <Border Background="{TemplateBinding Background}" 
                                            BorderThickness="{TemplateBinding BorderThickness}"
                                            Padding="{TemplateBinding Padding}">
                                        <ContentPresenter VerticalAlignment="Center"/>
                                    </Border>
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                        <Style.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter Property="Background" Value="{DynamicResource AccentLightBrush}"/>
                                <Setter Property="Foreground" Value="{DynamicResource AccentDefaultBrush}"/>
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                    
                    <!-- 行样式 -->
                    <Style TargetType="DataGridRow">
                        <Setter Property="Background" Value="{DynamicResource AppBackgroundBrush}"/>
                        <Style.Triggers>
                            <Trigger Property="AlternationIndex" Value="1">
                                <Setter Property="Background" Value="{DynamicResource BackgroundSecondaryBrush}"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="{DynamicResource ControlHoverBrush}"/>
                            </Trigger>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter Property="Background" Value="{DynamicResource AccentLightBrush}"/>
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </DataGrid.Resources>
                
                <DataGrid.Columns>
                    <!-- 功能描述列 -->
                    <DataGridTextColumn Header="功能描述" Binding="{Binding Description}" IsReadOnly="True" Width="2*">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock">
                                <Setter Property="FontSize" Value="14"/>
                                <Setter Property="VerticalAlignment" Value="Center"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    
                    <!-- 快捷键列 -->
                    <DataGridTextColumn Header="快捷键" Binding="{Binding KeyCombination}" IsReadOnly="True" Width="*">
                        <DataGridTextColumn.ElementStyle>
                            <Style TargetType="TextBlock">
                                <Setter Property="FontSize" Value="13"/>
                                <Setter Property="FontFamily" Value="Consolas"/>
                                <Setter Property="Foreground" Value="{DynamicResource AccentDefaultBrush}"/>
                                <Setter Property="FontWeight" Value="Medium"/>
                                <Setter Property="VerticalAlignment" Value="Center"/>
                            </Style>
                        </DataGridTextColumn.ElementStyle>
                    </DataGridTextColumn>
                    
                    <!-- 操作列 -->
                    <DataGridTemplateColumn Header="操作" Width="Auto">
                        <DataGridTemplateColumn.CellTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal">
                                    <Button Content="编辑" Click="EditHotkey_Click" Tag="{Binding}"
                                            Padding="12,6" Background="Transparent" BorderBrush="{DynamicResource BorderSubtleBrush}" 
                                            Foreground="{DynamicResource AccentDefaultBrush}" Cursor="Hand" FontSize="12" Margin="0,0,8,0"
                                            Style="{StaticResource ModernButtonStyle}"/>
                                    <!-- 恢复默认按钮 (仅修改项显示) -->
                                    <Button Content="恢复" Click="ResetSingleHotkey_Click" Tag="{Binding}"
                                            Padding="8,6" Background="Transparent" BorderBrush="{DynamicResource SemanticWarningBrush}" 
                                            Foreground="{DynamicResource SemanticWarningBrush}" Cursor="Hand" FontSize="11"
                                            Visibility="{Binding IsModified, Converter={StaticResource BoolToVisConverter}}"
                                            Style="{StaticResource ModernButtonStyle}"/>
                                </StackPanel>
                            </DataTemplate>
                        </DataGridTemplateColumn.CellTemplate>
                    </DataGridTemplateColumn>
                </DataGrid.Columns>
            </DataGrid>
        </Border>
        
        <!-- 底部说明 -->
        <TextBlock Grid.Row="3" Text="点击编辑按钮可自定义快捷键。修改会立即保存。" 
                   FontSize="12" Foreground="{DynamicResource ForegroundSecondaryBrush}" Margin="0,15,0,0"/>
    </Grid>
</UserControl>

