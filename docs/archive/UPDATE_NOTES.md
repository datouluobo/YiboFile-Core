# OoiMRR 更新说明

## 已修复的问题

### ✅ 1. 修复run.bat打开两个程序的问题
- **问题**：run.bat会同时打开两个程序实例
- **解决方案**：
  - 添加了`--no-build`参数避免重复编译
  - 增加了错误处理机制
  - 只有在编译失败时才重新编译

### ✅ 2. 修复标签点击乱码和切换功能
- **问题**：点击标签会乱码，显示有问题，并且不能实际切换，文件浏览器也不会随之变化
- **解决方案**：
  - 实现了完整的标签过滤功能
  - 修复了标签显示问题
  - 添加了按标签过滤文件的逻辑
  - 更新地址栏和面包屑导航显示当前过滤状态
  - 支持搜索当前目录及子目录下的所有文件

### ✅ 3. 调整预览框和备注区域布局
- **问题**：需要把预览框移动到右侧备注上方，占大部分面积，备注在下方占小部分
- **解决方案**：
  - 重新设计了右侧区域布局
  - 预览区占3/4的高度（3*）
  - 备注区占1/4的高度（1*）
  - 优化了间距和边距

### ✅ 4. 重新设计整体布局
- **问题**：需要把路径浏览/库/标签/搜索等功能列在整个程序界面的左侧，文件浏览器在界面中间部分
- **解决方案**：
  - 完全重新设计了界面布局
  - 左侧功能栏（250px宽度）：包含文件路径、库、标签、搜索4个标签页
  - 中间文件浏览器（自适应宽度）：主要的文件浏览区域
  - 右侧预览和备注区（400px宽度）：预览区在上，备注区在下
  - 底部信息区：显示文件详细信息

## 新的界面布局

```
┌─────────────────────────────────────────────────────────────────┐
│                        工具栏 (Menu)                            │
├─────────────┬─────────────────────────────┬─────────────────────┤
│             │                             │                     │
│   左侧功能栏   │        中间文件浏览器          │    右侧预览和备注区    │
│             │                             │                     │
│  ┌─────────┐ │  ┌─────────────────────────┐ │ ┌─────────────────┐ │
│  │文件路径  │ │  │      文件浏览器工具栏      │ │ │     预览区       │ │
│  │  库     │ │  │                         │ │ │   (占3/4高度)   │ │
│  │  标签   │ │  │      文件列表            │ │ │                 │ │
│  │  搜索   │ │  │                         │ │ └─────────────────┘ │
│  └─────────┘ │  └─────────────────────────┘ │ ┌─────────────────┐ │
│             │                             │ │     备注区       │ │
│             │                             │ │   (占1/4高度)    │ │
│             │                             │ └─────────────────┘ │
├─────────────┴─────────────────────────────┴─────────────────────┤
│                        文件信息区                                │
└─────────────────────────────────────────────────────────────────┘
```

## 功能改进

### 标签系统增强
- ✅ 点击标签可以真正过滤文件
- ✅ 支持搜索当前目录及所有子目录
- ✅ 显示过滤状态和当前标签
- ✅ 可以通过刷新按钮清除过滤

### 界面优化
- ✅ 左侧功能栏垂直排列，节省空间
- ✅ 搜索选项垂直排列，更清晰
- ✅ 预览区占更大面积，提供更好的预览体验
- ✅ 备注区紧凑布局，不占用过多空间

### 用户体验提升
- ✅ 更直观的三栏布局
- ✅ 功能区域划分更清晰
- ✅ 操作流程更顺畅
- ✅ 视觉层次更合理

## 技术改进

- ✅ 优化了数据库查询性能
- ✅ 改进了文件过滤算法
- ✅ 增强了错误处理机制
- ✅ 优化了内存使用

## 运行方式

1. **使用批处理文件**：双击 `run.bat`
2. **使用PowerShell脚本**：运行 `.\run.ps1`
3. **使用dotnet命令**：`dotnet run`

## 系统要求

- Windows 10/11
- .NET 8.0 Runtime
- 至少100MB可用磁盘空间

---

**所有问题已修复完成！** 🎉

现在您可以享受全新的OoiMRR文件资源管理器体验了。
